<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EntityMaker.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">core</a> &gt; <a href="index.source.html" class="el_package">io.github.maze11.factory</a> &gt; <span class="el_source">EntityMaker.java</span></div><h1>EntityMaker.java</h1><pre class="source lang-java linenums">package io.github.maze11.factory;

import java.util.ArrayList;
import java.util.List;

import com.badlogic.ashley.core.Entity;
import com.badlogic.ashley.core.PooledEngine;
import com.badlogic.gdx.audio.Sound;
import com.badlogic.gdx.graphics.Texture;
import com.badlogic.gdx.graphics.g2d.Animation;
import com.badlogic.gdx.graphics.g2d.TextureRegion;
import com.badlogic.gdx.math.Vector2;
import com.badlogic.gdx.physics.box2d.BodyDef;

import io.github.maze11.MazeGame;
import io.github.maze11.assetLoading.AssetId;
import io.github.maze11.assetLoading.AssetLoader;
import io.github.maze11.components.AnimationComponent;
import io.github.maze11.components.CameraFollowComponent;
import io.github.maze11.components.ChaserComponent;
import io.github.maze11.components.PlayerComponent;
import io.github.maze11.components.SpriteComponent;
import io.github.maze11.messages.*;

/**
 * Used to create entities. Has methods for all the entity instances that need to be created.
 * Constructs an entity by adding components in sequence.
 * Delegates much of component creation to ComponentMaker.
 */
public class EntityMaker {
    private final PooledEngine engine;
    private final AssetLoader assetLoader;
    private final ComponentMaker cMaker;

<span class="nc" id="L35">    public EntityMaker(PooledEngine engine, MazeGame game) {</span>
<span class="nc" id="L36">        this.engine = engine;</span>
<span class="nc" id="L37">        this.assetLoader = game.getAssetLoader();</span>
<span class="nc" id="L38">        this.cMaker = new ComponentMaker(engine, assetLoader);</span>
<span class="nc" id="L39">    }</span>

    private Entity makeEmptyEntity() {
<span class="nc" id="L42">        Entity entity = engine.createEntity();</span>
<span class="nc" id="L43">        engine.addEntity(entity);</span>
<span class="nc" id="L44">        return entity;</span>
    }

    public Entity makeFalseWall(float x, float y, float width, float height, String triggeredBy) {
<span class="nc" id="L48">        Entity entity = makeEmptyEntity();</span>

<span class="nc" id="L50">        cMaker.addTransform(entity, x + width / 2, y + height / 2, width, height);</span>
<span class="nc" id="L51">        cMaker.addSprite(entity, AssetId.FALSE_WALL);</span>
<span class="nc" id="L52">        cMaker.addBoxCollider(entity, x + width / 2, y + height / 2, width, height, 0f, 0f, BodyDef.BodyType.StaticBody, false);</span>
<span class="nc" id="L53">        cMaker.addHiddenWall(entity,  triggeredBy);</span>

<span class="nc" id="L55">        SpriteComponent sprite = entity.getComponent(SpriteComponent.class);</span>
<span class="nc" id="L56">        sprite.textureOffset.set(sprite.textureOffset.x, sprite.textureOffset.y - 1f);</span>

<span class="nc" id="L58">        return entity;</span>
    }

    public Entity makePressurePlate(float x, float y, String triggers) {
<span class="nc" id="L62">        List&lt;Message&gt; additionalMessages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L63">        additionalMessages.add(new SoundMessage(assetLoader.get(AssetId.PRESSURE_PLATE_SOUND, Sound.class), 1f));</span>
<span class="nc" id="L64">        additionalMessages.add(new ToastMessage(&quot;You hear a click... A secret door has opened!&quot;, 2.5f));</span>

<span class="nc" id="L66">        Entity entity = makeInteractable(x, y, new PressurePlateTriggerMessage(triggers), true, AssetId.PRESSURE_PLATE, additionalMessages);</span>
<span class="nc" id="L67">        cMaker.addCircleCollider(entity, x, y, 0.75f, 0f, 0.5f, BodyDef.BodyType.StaticBody);</span>
<span class="nc" id="L68">        return entity;</span>
    }

    public Entity makeBlackoutTrigger(float x, float y, float width, float height) {
<span class="nc" id="L72">        List&lt;Message&gt; additionalMessages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L73">        additionalMessages.add(new ToastMessage(&quot;A blackout! The generator should turn back on in a couple seconds...&quot;, 5f));</span>

<span class="nc" id="L75">        Entity entity = makeInteractable(x, y, new InteractableMessage(MessageType.BLACKOUT), true, AssetId.INVISIBLE, additionalMessages);</span>
<span class="nc" id="L76">        cMaker.addBoxCollider(entity, x + width / 2, y + height / 2, width, height, 1.5f, 3f, BodyDef.BodyType.StaticBody,false);</span>
<span class="nc" id="L77">        return entity;</span>
    }
    public Entity makeComboPuzzle(float x, float y, String solution) {
<span class="nc" id="L80">        List&lt;Message&gt; additionalMessages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L81">        Entity entity = makeInteractable(x, y, new OpenPasswordMessage(), false, AssetId.INVISIBLE, additionalMessages);</span>
        //answer is hard-coded, but there is possibility to expand this in the future
<span class="nc" id="L83">        cMaker.addCombinationPuzzle(entity,solution);</span>
<span class="nc" id="L84">        cMaker.addSprite(entity, AssetId.SAFE);</span>
<span class="nc" id="L85">        cMaker.addCircleCollider(entity, x, y, 0.75f, 0f, 0.5f, BodyDef.BodyType.StaticBody);</span>
<span class="nc" id="L86">        return entity;</span>
    }

    public Entity makeSlipperyTrigger(float x, float y, float width, float height, boolean slips) {
<span class="nc" id="L90">        List&lt;Message&gt; additionalMessages = new ArrayList&lt;&gt;();</span>
        //additionalMessages.add(new ToastMessage(&quot;Uh-oh! Your shoes are coated in slippery soapy water, watch where you're going...&quot;, 5f));
<span class="nc" id="L92">        Entity entity = makeInteractable(x, y, new SlipMessage(slips), false, AssetId.INVISIBLE, additionalMessages);</span>
<span class="nc" id="L93">        cMaker.addBoxCollider(entity, x + width / 2, y + height / 2, width, height, 1f, 2f, BodyDef.BodyType.StaticBody, false);</span>
<span class="nc" id="L94">        cMaker.addSlipTrigger(entity,slips);</span>
<span class="nc" id="L95">        return entity;</span>
    }

    public Entity makeSurveyor(float x, float y){
<span class="nc" id="L99">        Entity entity = makeEmptyEntity();</span>

<span class="nc" id="L101">        List&lt;Message&gt; messages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L102">        messages.add(new SoundMessage(assetLoader.get(AssetId.GOOSE_HONK, Sound.class),</span>
            1f));

<span class="nc" id="L105">        cMaker.addTransform(entity, x, y);</span>
<span class="nc" id="L106">        cMaker.addSprite(entity, null, 2f, 2f, 0f, -0.3f);</span>
<span class="nc" id="L107">        cMaker.addChaser(entity, x, y,4f,0.5f);</span>
<span class="nc" id="L108">        cMaker.addInteractable(entity, new OpenSurveyMessage(), false, messages);</span>
<span class="nc" id="L109">        cMaker.addBoxCollider(entity, x, y,</span>
            0.9f, 0.9f,
            0f, 0.4f,
            BodyDef.BodyType.DynamicBody,
            true);

        // Animation
<span class="nc" id="L116">        AnimationComponent&lt;ChaserComponent.ChaseAnimState&gt; anim = (AnimationComponent&lt;ChaserComponent.ChaseAnimState&gt;) engine</span>
<span class="nc" id="L117">            .createComponent(AnimationComponent.class);</span>

<span class="nc" id="L119">        Texture sheet = assetLoader.get(AssetId.SURVEYOR_SHEET, Texture.class);</span>

        // Build animations for goose
<span class="nc" id="L122">        float idleTime = 0.25f;</span>
<span class="nc" id="L123">        float walkTime = 0.12f;</span>
<span class="nc" id="L124">        record GAnim(ChaserComponent.ChaseAnimState state, int start, int end, float time) {</span>
        }
<span class="nc" id="L126">        GAnim[] table = {</span>
            // IDLE
            new GAnim(ChaserComponent.ChaseAnimState.IDLE_RIGHT, 0, 5, idleTime),
            new GAnim(ChaserComponent.ChaseAnimState.IDLE_UP, 6, 11, idleTime),
            new GAnim(ChaserComponent.ChaseAnimState.IDLE_LEFT, 12, 17, idleTime),
            new GAnim(ChaserComponent.ChaseAnimState.IDLE_DOWN, 18, 23, idleTime),

            // WALK
            new GAnim(ChaserComponent.ChaseAnimState.WALK_RIGHT, 0, 5, walkTime),
            new GAnim(ChaserComponent.ChaseAnimState.WALK_UP, 6, 11, walkTime),
            new GAnim(ChaserComponent.ChaseAnimState.WALK_LEFT, 12, 17, walkTime),
            new GAnim(ChaserComponent.ChaseAnimState.WALK_DOWN, 18, 23, walkTime)
        };

<span class="nc bnc" id="L140" title="All 2 branches missed.">        for (GAnim g : table) {</span>
<span class="nc" id="L141">            anim.animations.put(g.state(), loadFrames(sheet, 64, 64, 2, g.start(), g.end(), g.time()));</span>
        }

        // Starting animation
<span class="nc" id="L145">        anim.currentState = ChaserComponent.ChaseAnimState.IDLE_DOWN;</span>
<span class="nc" id="L146">        anim.elapsed = 0f;</span>

<span class="nc" id="L148">        entity.add(anim);</span>

<span class="nc" id="L150">        return entity;</span>
    }

    // Creates a wall entity with box collider
    public Entity makeWall(float x, float y, float width, float height) {
<span class="nc" id="L155">        Entity entity = makeEmptyEntity();</span>
<span class="nc" id="L156">        cMaker.addBoxCollider(entity, x + width / 2, y + height / 2, width, height, 0f, 0f,</span>
                BodyDef.BodyType.StaticBody, false);
<span class="nc" id="L158">        return entity;</span>
    }

    /** Creates the player entity with sprite, camera follow, and physics */
    public Entity makePlayer(float x, float y) {
<span class="nc" id="L163">        Entity entity = makeEmptyEntity();</span>

<span class="nc" id="L165">        cMaker.addTransform(entity, x, y);</span>
<span class="nc" id="L166">        cMaker.addSprite(entity, null, 1f, 2f, 0f, 0.05f);</span>
<span class="nc" id="L167">        entity.add(engine.createComponent(PlayerComponent.class));</span>

        // Camera follows the player
<span class="nc" id="L170">        entity.add(engine.createComponent(CameraFollowComponent.class));</span>

        // Physics
<span class="nc" id="L173">        cMaker.addBoxCollider(entity, x, y, 0.70f, 0.70f,</span>
                0f, 0.5f,
                BodyDef.BodyType.DynamicBody,
                true);
<span class="nc" id="L177">        cMaker.addAudioListener(entity, new Vector2(0f, 1f));</span>

<span class="nc" id="L179">        AnimationComponent&lt;PlayerComponent.PlayerState&gt; anim = (AnimationComponent&lt;PlayerComponent.PlayerState&gt;) engine</span>
<span class="nc" id="L180">                .createComponent(AnimationComponent.class);</span>

        // Load player spritesheet
<span class="nc" id="L183">        Texture sheet = assetLoader.get(AssetId.PLAYER_SHEET, Texture.class);</span>

<span class="nc" id="L185">        PlayerComponent.PlayerState[] idleStates = {</span>
                PlayerComponent.PlayerState.IDLE_RIGHT,
                PlayerComponent.PlayerState.IDLE_UP,
                PlayerComponent.PlayerState.IDLE_LEFT,
                PlayerComponent.PlayerState.IDLE_DOWN
        };

<span class="nc" id="L192">        PlayerComponent.PlayerState[] walkStates = {</span>
                PlayerComponent.PlayerState.WALK_RIGHT,
                PlayerComponent.PlayerState.WALK_UP,
                PlayerComponent.PlayerState.WALK_LEFT,
                PlayerComponent.PlayerState.WALK_DOWN
        };

        // Starting frame index for each direction: 0, 6, 12, 18
<span class="nc" id="L200">        int[] frameStarts = { 0, 6, 12, 18 };</span>

<span class="nc bnc" id="L202" title="All 2 branches missed.">        for (int i = 0; i &lt; 4; i++) {</span>
            // IDLE animations (row 1)
<span class="nc" id="L204">            anim.animations.put(</span>
                    idleStates[i],
<span class="nc" id="L206">                    loadFrames(sheet, 32, 64,</span>
                            1, frameStarts[i], frameStarts[i] + 5,
                            0.12f));

            // WALK animations (row 2)
<span class="nc" id="L211">            anim.animations.put(</span>
                    walkStates[i],
<span class="nc" id="L213">                    loadFrames(sheet, 32, 64,</span>
                            2, frameStarts[i], frameStarts[i] + 5,
                            0.12f));
        }

<span class="nc" id="L218">        anim.currentState = PlayerComponent.PlayerState.IDLE_DOWN;</span>

<span class="nc" id="L220">        entity.add(anim);</span>


<span class="nc" id="L223">        return entity;</span>
    }

    private Animation&lt;TextureRegion&gt; loadFrames(Texture sheet, int frameW, int frameH, int[][] coords,
            float frameTime) {

<span class="nc" id="L229">        TextureRegion[][] all = TextureRegion.split(sheet, frameW, frameH);</span>

<span class="nc" id="L231">        TextureRegion[] selected = new TextureRegion[coords.length];</span>

<span class="nc bnc" id="L233" title="All 2 branches missed.">        for (int i = 0; i &lt; coords.length; i++) {</span>
<span class="nc" id="L234">            int row = coords[i][0];</span>
<span class="nc" id="L235">            int col = coords[i][1];</span>

            // Defensive: ensure coords donâ€™t explode
<span class="nc bnc" id="L238" title="All 4 branches missed.">            if (row &lt; all.length &amp;&amp; col &lt; all[row].length)</span>
<span class="nc" id="L239">                selected[i] = all[row][col];</span>
            else
<span class="nc" id="L241">                selected[i] = all[0][0]; // fallback frame</span>
        }

<span class="nc" id="L244">        return new Animation&lt;&gt;(frameTime, selected);</span>
    }

    /**
     * Convenience: loads frames from a single row, using a start and end column.
     * Delegates to the main loadFrames()
     */
    private Animation&lt;TextureRegion&gt; loadFrames(Texture sheet, int frameW, int frameH, int row, int startCol,
            int endCol, float frameTime) {

        // Safety: cap end column to sheet width
<span class="nc" id="L255">        TextureRegion[][] all = TextureRegion.split(sheet, frameW, frameH);</span>
<span class="nc" id="L256">        int maxCols = all[row].length - 1;</span>
<span class="nc" id="L257">        endCol = Math.min(endCol, maxCols);</span>

<span class="nc" id="L259">        int count = (endCol - startCol) + 1;</span>

<span class="nc" id="L261">        int[][] coords = new int[count][];</span>

<span class="nc bnc" id="L263" title="All 2 branches missed.">        for (int i = 0; i &lt; count; i++) {</span>
<span class="nc" id="L264">            coords[i] = new int[] { row, startCol + i };</span>
        }

<span class="nc" id="L267">        return loadFrames(sheet, frameW, frameH, coords, frameTime);</span>
    }

    // Creates a countdown timer entity
    public Entity makeTimer(float durationSeconds) {
<span class="nc" id="L272">        Entity entity = makeEmptyEntity();</span>
<span class="nc" id="L273">        cMaker.addTimer(entity, durationSeconds);</span>
<span class="nc" id="L274">        return entity;</span>
    }

    private Entity makeInteractable(float x, float y, InteractableMessage message, boolean disappearOnInteract,
            AssetId assetId, List&lt;Message&gt; additionalMessages) {
<span class="nc" id="L279">        Entity entity = makeEmptyEntity();</span>
<span class="nc" id="L280">        cMaker.addTransform(entity, x, y);</span>
<span class="nc" id="L281">        cMaker.addSprite(entity, assetId);</span>
<span class="nc" id="L282">        cMaker.addInteractable(entity, message, disappearOnInteract, additionalMessages);</span>

<span class="nc" id="L284">        return entity;</span>
    }

    public Entity makeCoffee(float x, float y) {
<span class="nc" id="L288">        List&lt;Message&gt; additionalMessages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L289">        additionalMessages.add(new SoundMessage(assetLoader.get(AssetId.COFFEE_SLURP, Sound.class), 1f));</span>
<span class="nc" id="L290">        additionalMessages.add(new ToastMessage(&quot;Coffee drank! +Speed&quot;, 2f));</span>

<span class="nc" id="L292">        Entity entity = makeInteractable(x, y, new CoffeeCollectMessage(), true, AssetId.COFFEE, additionalMessages);</span>
<span class="nc" id="L293">        cMaker.addCircleCollider(entity, x, y, 0.75f, 0f, 0.5f, BodyDef.BodyType.StaticBody);</span>
<span class="nc" id="L294">        return entity;</span>
    }

    public Entity makeCheckInCode(float x, float y) {
<span class="nc" id="L298">        List&lt;Message&gt; additionalMessages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L299">        additionalMessages.add(new SoundMessage(assetLoader.get(AssetId.COLLECTABLE_SOUND, Sound.class), 1f));</span>
<span class="nc" id="L300">        additionalMessages.add(new ToastMessage(&quot;Check-in code collected! +20 Points&quot;, 2f));</span>

<span class="nc" id="L302">        Entity entity = makeInteractable(x, y, new InteractableMessage(MessageType.CHECK_IN_CODE_COLLECT), true,</span>
                AssetId.CHECK_IN, additionalMessages);
<span class="nc" id="L304">        cMaker.addCircleCollider(entity, x, y, 0.75f, 0f, 0.5f, BodyDef.BodyType.StaticBody);</span>
<span class="nc" id="L305">        return entity;</span>
    }

    public Entity makeClock(float x, float y) {
<span class="nc" id="L309">        List&lt;Message&gt; additionalMessages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L310">        additionalMessages.add(new SoundMessage(assetLoader.get(AssetId.COLLECTABLE_SOUND, Sound.class), 1f));</span>
<span class="nc" id="L311">        additionalMessages.add(new ToastMessage(&quot;Clock collected! 10 Seconds added!&quot;, 2f));</span>

<span class="nc" id="L313">        Entity entity = makeInteractable(x, y, new InteractableMessage(MessageType.CLOCK_COLLECT), true,</span>
            AssetId.CLOCK, additionalMessages);
<span class="nc" id="L315">        cMaker.addCircleCollider(entity, x, y, 0.75f, 0f, 0.5f, BodyDef.BodyType.StaticBody);</span>
<span class="nc" id="L316">        return entity;</span>
    }

    public Entity makeExit(float x, float y) {
<span class="nc" id="L320">        Entity entity = makeInteractable(x, y, new InteractableMessage(MessageType.EXIT_MAZE), false, AssetId.EXIT, null);</span>
<span class="nc" id="L321">        cMaker.addBoxCollider(entity, x, y, 1.6f, 2.2f, 0f, 0.5f,</span>
                BodyDef.BodyType.StaticBody, true);

<span class="nc" id="L324">        SpriteComponent sprite = entity.getComponent(SpriteComponent.class);</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">        if (sprite != null) {</span>
<span class="nc" id="L326">            sprite.size.set(3f, 3f);</span>
<span class="nc" id="L327">            sprite.textureOffset.set(sprite.textureOffset.x, sprite.textureOffset.y - 1f);</span>
        }

<span class="nc" id="L330">        return entity;</span>
    }

    public Entity makeGoose(float x, float y) {
<span class="nc" id="L334">        Entity entity = makeEmptyEntity();</span>

<span class="nc" id="L336">        List&lt;Message&gt; messages = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L337">        messages.add(new SoundMessage(assetLoader.get(AssetId.GOOSE_HONK, Sound.class),</span>
            1f));

<span class="nc" id="L340">        cMaker.addTransform(entity, x, y);</span>
<span class="nc" id="L341">        cMaker.addSprite(entity, null, 2f, 2f, 0f, -0.3f);</span>
<span class="nc" id="L342">        cMaker.addChaser(entity, x, y,7f,1f);</span>
<span class="nc" id="L343">        cMaker.addInteractable(entity, new GooseBiteMessage(), false, messages);</span>
<span class="nc" id="L344">        cMaker.addBoxCollider(entity, x, y,</span>
                0.9f, 0.9f,
                0f, 0.4f,
                BodyDef.BodyType.DynamicBody,
                true);

        // Animation
<span class="nc" id="L351">        AnimationComponent&lt;ChaserComponent.ChaseAnimState&gt; anim = (AnimationComponent&lt;ChaserComponent.ChaseAnimState&gt;) engine</span>
<span class="nc" id="L352">                .createComponent(AnimationComponent.class);</span>

<span class="nc" id="L354">        Texture sheet = assetLoader.get(AssetId.GOOSE_SHEET, Texture.class);</span>

        // Build animations for goose
<span class="nc" id="L357">        float idleTime = 0.25f;</span>
<span class="nc" id="L358">        float walkTime = 0.12f;</span>
<span class="nc" id="L359">        record GAnim(ChaserComponent.ChaseAnimState state, int start, int end, float time) {</span>
        }
<span class="nc" id="L361">        GAnim[] table = {</span>
                // IDLE
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_RIGHT, 0, 5, idleTime),
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_UP, 6, 11, idleTime),
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_LEFT, 12, 17, idleTime),
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_DOWN, 18, 23, idleTime),

                // WALK
                new GAnim(ChaserComponent.ChaseAnimState.WALK_RIGHT, 0, 5, walkTime),
                new GAnim(ChaserComponent.ChaseAnimState.WALK_UP, 6, 11, walkTime),
                new GAnim(ChaserComponent.ChaseAnimState.WALK_LEFT, 12, 17, walkTime),
                new GAnim(ChaserComponent.ChaseAnimState.WALK_DOWN, 18, 23, walkTime)
        };

<span class="nc bnc" id="L375" title="All 2 branches missed.">        for (GAnim g : table) {</span>
<span class="nc" id="L376">            anim.animations.put(g.state(), loadFrames(sheet, 64, 64, 2, g.start(), g.end(), g.time()));</span>
        }

        // Starting animation
<span class="nc" id="L380">        anim.currentState = ChaserComponent.ChaseAnimState.IDLE_DOWN;</span>
<span class="nc" id="L381">        anim.elapsed = 0f;</span>

<span class="nc" id="L383">        entity.add(anim);</span>

<span class="nc" id="L385">        return entity;</span>
    }

    public Entity makeLecturer(float x, float y) {
<span class="nc" id="L389">        Entity entity = makeEmptyEntity();</span>

<span class="nc" id="L391">        List&lt;Message&gt; messages = new ArrayList&lt;&gt;();</span>
        //messages.add(new SoundMessage(assetLoader.get(AssetId.GOOSE_HONK, Sound.class),
        //    1f));

<span class="nc" id="L395">        cMaker.addTransform(entity, x, y);</span>
<span class="nc" id="L396">        cMaker.addSprite(entity, null, 2f, 2f, 0f, -0.3f);</span>
<span class="nc" id="L397">        cMaker.addChaser(entity, x, y,4f,0.5f);</span>
<span class="nc" id="L398">        cMaker.addInteractable(entity, new LectureMessage(), false, messages);</span>
<span class="nc" id="L399">        cMaker.addBoxCollider(entity, x, y,</span>
                0.9f, 0.9f,
                0f, 0.4f,
                BodyDef.BodyType.DynamicBody,
                true);

        // Animation
<span class="nc" id="L406">        AnimationComponent&lt;ChaserComponent.ChaseAnimState&gt; anim = (AnimationComponent&lt;ChaserComponent.ChaseAnimState&gt;) engine</span>
<span class="nc" id="L407">                .createComponent(AnimationComponent.class);</span>

<span class="nc" id="L409">        Texture sheet = assetLoader.get(AssetId.LECTURER_SHEET, Texture.class);</span>

        // Build animations for goose
<span class="nc" id="L412">        float idleTime = 0.25f;</span>
<span class="nc" id="L413">        float walkTime = 0.12f;</span>
<span class="nc" id="L414">        record GAnim(ChaserComponent.ChaseAnimState state, int start, int end, float time) {</span>
        }
<span class="nc" id="L416">        GAnim[] table = {</span>
                // IDLE
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_RIGHT, 0, 0, idleTime),
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_UP, 0, 0, idleTime),
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_LEFT, 0, 0, idleTime),
                new GAnim(ChaserComponent.ChaseAnimState.IDLE_DOWN, 0, 0, idleTime),

                // WALK
                new GAnim(ChaserComponent.ChaseAnimState.WALK_RIGHT, 0, 0, walkTime),
                new GAnim(ChaserComponent.ChaseAnimState.WALK_UP, 0, 0, walkTime),
                new GAnim(ChaserComponent.ChaseAnimState.WALK_LEFT, 0, 0, walkTime),
                new GAnim(ChaserComponent.ChaseAnimState.WALK_DOWN, 0, 0, walkTime)
        };

<span class="nc bnc" id="L430" title="All 2 branches missed.">        for (GAnim g : table) {</span>
<span class="nc" id="L431">            anim.animations.put(g.state(), loadFrames(sheet, 32, 32, 0, g.start(), g.end(), g.time()));</span>
        }

        // Starting animation
<span class="nc" id="L435">        anim.currentState = ChaserComponent.ChaseAnimState.IDLE_DOWN;</span>
<span class="nc" id="L436">        anim.elapsed = 0f;</span>

<span class="nc" id="L438">        entity.add(anim);</span>

<span class="nc" id="L440">        return entity;</span>
    }


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>